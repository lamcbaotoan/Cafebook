<Window x:Class="Cafebook.Views.admin.ManHinhAdmin"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Cafebook.Views.admin.pages"
      mc:Ignorable="d" 
        Title="Cafebook - Bảng điều khiển" Height="720" Width="1280"
        WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI"
        Loaded="Window_Loaded">

    <Window.Resources>
        <Style x:Key="NavButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#D5D8DC"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Left" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#4A5A6A"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Thanh điều hướng bên trái -->
        <Grid Grid.Column="0" Background="#2C3E50">
            <DockPanel>
                <Button x:Name="btnDangXuat" Content="Đăng xuất" DockPanel.Dock="Bottom" Height="50" 
                        Background="#E74C3C" Foreground="White" BorderThickness="0" FontSize="14"
                        Click="BtnDangXuat_Click"/>

                <Button x:Name="btnThongBao" DockPanel.Dock="Bottom" Style="{StaticResource NavButton}"
                        Click="BtnThongBao_Click" ToolTip="Xem thông báo mới">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Path Grid.Column="0" Data="M12,22C13.1,22 14,21.1 14,20H10C10,21.1 10.9,22 12,22M18,16V11C18,7.93 16.36,5.36 13.5,4.68V4C13.5,3.17 12.83,2.5 12,2.5C11.17,2.5 10.5,3.17 10.5,4V4.68C7.63,5.36 6,7.93 6,11V16L4,18V19H20V18L18,16Z" 
                              Fill="#D5D8DC" Width="16" Height="16" Stretch="Uniform" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="Thông báo" Margin="15,0,0,0"/>
                        <Border Grid.Column="2" x:Name="BadgeThongBao" Background="Red" CornerRadius="10" 
                                Padding="5,2" MinWidth="20" Visibility="Collapsed">
                            <TextBlock x:Name="lblSoThongBao" Text="0" Foreground="White" FontSize="10" FontWeight="Bold"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </Grid>
                </Button>

                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Cafebook" FontSize="24" FontWeight="Bold" Foreground="White" 
                                   HorizontalAlignment="Center" Margin="0,20,0,30"/>
                        <Button x:Name="btnTongQuan" Content="Tổng quan &amp; Báo cáo" Style="{StaticResource NavButton}" Click="BtnTongQuan_Click"/>
                        <Button x:Name="btnSanPham" Content="Quản lý Sản phẩm" Style="{StaticResource NavButton}" Click="BtnSanPham_Click"/>
                        <Button x:Name="btnBan" Content="Quản lý Bàn" Style="{StaticResource NavButton}" Click="BtnBan_Click"/>
                        <Button x:Name="btnKho" Content="Quản lý Kho" Style="{StaticResource NavButton}" Click="BtnKho_Click"/>
                        <Button x:Name="btnDonHang" Content="Quản lý Đơn hàng" Style="{StaticResource NavButton}" Click="BtnDonHang_Click"/>
                        <Button x:Name="btnSach" Content="Quản lý Sách" Style="{StaticResource NavButton}" Click="BtnSach_Click"/>
                        <Button x:Name="btnNhanSu" Content="Quản lý Nhân sự" Style="{StaticResource NavButton}" Click="BtnNhanSu_Click"/>
                        <Button x:Name="btnKhachHang" Content="Quản lý KH &amp; KM" Style="{StaticResource NavButton}" Click="BtnKhachHang_Click"/>
                    </StackPanel>
                </ScrollViewer>
            </DockPanel>
        </Grid>

        <!-- Khu vực nội dung chính -->
        <Grid Grid.Column="1">
            <Frame x:Name="MainFrame" NavigationUIVisibility="Hidden" Background="#F4F6F7"/>

            <!-- Popup hiển thị danh sách thông báo -->
            <Popup x:Name="PopupThongBao" IsOpen="False" StaysOpen="False" PlacementTarget="{Binding ElementName=btnThongBao}"
                   Placement="Right" AllowsTransparency="True" PopupAnimation="Fade"
                   Panel.ZIndex="1">
                <!-- ĐÃ THÊM ZINDEX VÀO ĐÂY -->
                <Border Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="5"
                        Width="350" MaxHeight="400" Margin="5,0,0,-50">
                    <Border.Effect>
                        <DropShadowEffect ShadowDepth="2" Color="#CCC" Opacity="0.5" BlurRadius="10"/>
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <TextBlock Text="Thông báo mới" Grid.Row="0" FontWeight="Bold" FontSize="16" Margin="15"/>
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <ItemsControl x:Name="icThongBaoPopup">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border BorderBrush="#EEE" BorderThickness="0,0,0,1" Padding="15,10"
                                                x:Name="ThongBaoItemBorder" MouseLeftButtonUp="ThongBaoItem_MouseLeftButtonUp"
                                                Background="Transparent" Cursor="Hand">
                                            <StackPanel>
                                                <TextBlock Text="{Binding NoiDung}" TextWrapping="Wrap"/>
                                                <TextBlock FontStyle="Italic" FontSize="11" Foreground="Gray" Margin="0,5,0,0">
                                                    <Run Text="{Binding TenNhanVien}"/> - <Run Text="{Binding ThoiGianTao, StringFormat='HH:mm dd/MM'}"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Popup>
        </Grid>
    </Grid>
</Window>