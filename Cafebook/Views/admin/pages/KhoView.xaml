<Page x:Class="Cafebook.Views.admin.pages.KhoView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Cafebook.Views.admin.pages"
      mc:Ignorable="d" 
      d:DesignHeight="650" d:DesignWidth="1050"
      Title="KhoView" FontFamily="Segoe UI" Loaded="Page_Loaded">
    <TabControl>
        <TabItem Header="Tồn Kho">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="250"/>
                </Grid.RowDefinitions>
                <GroupBox Grid.Row="0" Header="Tất cả Nguyên liệu trong kho" FontSize="14" FontWeight="SemiBold">
                    <DataGrid x:Name="dgTonKho" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding IdNguyenLieu}" Width="50"/>
                            <DataGridTextColumn Header="Tên Nguyên liệu" Binding="{Binding TenNguyenLieu}" Width="*"/>
                            <DataGridTextColumn Header="Số lượng tồn" Binding="{Binding SoLuongTon}" Width="150"/>
                            <DataGridTextColumn Header="Đơn vị tính" Binding="{Binding DonViTinh}" Width="150"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
                <GroupBox Grid.Row="1" Header="Cảnh báo Tồn kho thấp (Tự động)" Margin="0,10,0,0" FontSize="14" FontWeight="SemiBold" Foreground="Red">
                    <DataGrid x:Name="dgCanhBao" AutoGenerateColumns="False" IsReadOnly="True">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding IdNguyenLieu}" Width="50"/>
                            <DataGridTextColumn Header="Tên Nguyên liệu" Binding="{Binding TenNguyenLieu}" Width="*"/>
                            <DataGridTextColumn Header="SL Tồn" Binding="{Binding SoLuongTon}" Width="100"/>
                            <DataGridTextColumn Header="ĐVT" Binding="{Binding DonViTinh}" Width="80"/>
                            <DataGridTextColumn Header="Ngưỡng" Binding="{Binding NguongCanhBao}" Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
            </Grid>
        </TabItem>

        <TabItem Header="Quản lý Nguyên liệu">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <DataGrid Grid.Column="0" x:Name="dgNguyenLieu" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" SelectionChanged="DgNguyenLieu_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding IdNguyenLieu}" Width="50"/>
                        <DataGridTextColumn Header="Tên Nguyên Liệu" Binding="{Binding TenNguyenLieu}" Width="*"/>
                        <DataGridTextColumn Header="ĐVT Cơ bản" Binding="{Binding DonViTinh}" Width="100"/>
                        <DataGridTextColumn Header="Ngưỡng Cảnh báo" Binding="{Binding NguongCanhBao}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>
                <StackPanel Grid.Column="1" Width="300" Margin="10,0,0,0">
                    <GroupBox Header="Thông tin Nguyên liệu">
                        <StackPanel Margin="10">
                            <Label Content="Tên nguyên liệu:"/>
                            <TextBox x:Name="txtTenNL_crud" Margin="0,0,0,10"/>
                            <Label Content="Đơn vị tính cơ bản (để tồn kho):"/>
                            <ComboBox x:Name="cmbDonViTinh_crud" Margin="0,0,0,10" IsEditable="True">
                                <ComboBoxItem Content="kg"/>
                                <ComboBoxItem Content="lít"/>
                                <ComboBoxItem Content="cái"/>
                                <ComboBoxItem Content="quả"/>
                                <ComboBoxItem Content="chai"/>
                                <ComboBoxItem Content="hộp"/>
                            </ComboBox>
                            <Label Content="Ngưỡng cảnh báo hết hàng:"/>
                            <TextBox x:Name="txtNguongCanhBao_crud" Margin="0,0,0,15"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="btnLamMoiNL" Content="Làm mới" Margin="5" Padding="10,5" Click="BtnLamMoiNL_Click"/>
                                <Button x:Name="btnThemNL" Content="Thêm" Margin="5" Padding="10,5" Click="BtnThemNL_Click"/>
                                <Button x:Name="btnLuuNL" Content="Lưu" Margin="5" Padding="10,5" Click="BtnLuuNL_Click"/>
                                <Button x:Name="btnXoaNL" Content="Xóa" Margin="5" Padding="10,5" Background="IndianRed" Foreground="White" Click="BtnXoaNL_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </Grid>
        </TabItem>

        <TabItem Header="Nhập Kho">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="3*"/>
                </Grid.ColumnDefinitions>

                <DataGrid Grid.Column="0" Margin="0,0,10,0" x:Name="dgPhieuNhap" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" SelectionChanged="DgPhieuNhap_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding IdPhieuNhap}" Width="40"/>
                        <DataGridTextColumn Header="Ngày nhập" Binding="{Binding NgayNhap, StringFormat='dd/MM/yyyy'}" Width="100"/>
                        <DataGridTextColumn Header="Nhà Cung Cấp" Binding="{Binding TenNhaCungCap}" Width="*"/>
                        <DataGridTextColumn Header="Tổng tiền" Binding="{Binding TongTien, StringFormat=N0}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>

                <ScrollViewer Grid.Column="1">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button x:Name="btnTaoPhieuMoi" Content="Tạo Phiếu Nhập Mới" Margin="5" Padding="10,5" Click="BtnTaoPhieuMoi_Click"/>
                            <Button x:Name="btnLuuPhieuNhap" Content="Lưu Phiếu Nhập" Margin="5" Padding="10,5" Background="#27AE60" Foreground="White" Click="BtnLuuPhieuNhap_Click"/>
                        </StackPanel>

                        <GroupBox Header="Thông tin Phiếu nhập" Margin="0,5,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Grid.Row="0" Grid.Column="0" Content="Ngày nhập:"/>
                                <DatePicker Grid.Row="0" Grid.Column="1" x:Name="dpNgayNhap" Margin="5"/>
                                <Label Grid.Row="1" Grid.Column="0" Content="Nhà cung cấp:"/>
                                <ComboBox Grid.Row="1" Grid.Column="1" x:Name="cmbNhaCungCap_PhieuNhap" Margin="5" DisplayMemberPath="TenNhaCungCap" SelectedValuePath="IdNhaCungCap"/>
                                <Label Grid.Row="2" Grid.Column="0" Content="Tổng tiền:"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="lblTongTien" Margin="5" FontSize="16" FontWeight="Bold" Foreground="Red" Text="0 VND"/>
                            </Grid>
                        </GroupBox>

                        <GroupBox Header="Chi tiết Nguyên liệu" Margin="0,10,0,0">
                            <StackPanel>
                                <DataGrid x:Name="dgChiTietPhieuNhap" AutoGenerateColumns="False" MaxHeight="200" IsReadOnly="True">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Tên Nguyên liệu" Binding="{Binding TenNguyenLieu}" Width="*"/>
                                        <DataGridTextColumn Header="Số lượng" Binding="{Binding SoLuong}" Width="80"/>
                                        <DataGridTextColumn Header="Đơn giá" Binding="{Binding DonGia, StringFormat=N0}" Width="100"/>
                                        <DataGridTextColumn Header="Thành tiền" Binding="{Binding ThanhTien, StringFormat=N0}" Width="100" IsReadOnly="True"/>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <Grid Margin="0,10,0,0">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <ComboBox Grid.Column="0" x:Name="cmbNguyenLieu_PhieuNhap" DisplayMemberPath="TenNguyenLieu" SelectedValuePath="IdNguyenLieu" SelectionChanged="CmbNguyenLieu_PhieuNhap_SelectionChanged"/>
                                    <TextBox Grid.Column="1" x:Name="txtSoLuongNL" Width="70" Margin="5,0" ToolTip="Số lượng"/>
                                    <ComboBox Grid.Column="2" x:Name="cmbDonViNhap" Width="60" Margin="5,0"/>
                                    <TextBox Grid.Column="3" x:Name="txtDonGiaNL" Width="90" Margin="5,0" ToolTip="Đơn giá (theo đơn vị cơ bản)"/>
                                    <Button Grid.Column="4" x:Name="btnThemVaoPhieu" Content="Thêm" Padding="10,5" Click="BtnThemVaoPhieu_Click"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Hóa đơn Đầu vào" Margin="0,10,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <Image x:Name="imgHoaDon" Height="150" Stretch="Uniform" Margin="5" Source="pack://application:,,,/Resources/placeholder.png"/>
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock x:Name="lblDuongDanFile" Text="Chưa có ảnh hóa đơn." TextWrapping="Wrap" MaxWidth="150" FontStyle="Italic" Foreground="Gray"/>
                                    <Button x:Name="btnChonAnhHD" Content="Chọn ảnh..." Margin="0,10,0,0" Padding="10,5" Click="BtnChonAnhHD_Click"/>
                                    <Button x:Name="btnLuuHD" Content="Lưu Hóa đơn" Margin="0,5" Padding="10,5" Click="BtnLuuHD_Click"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </TabItem>
        <TabItem Header="Nhà Cung Cấp">
            <Grid Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <DataGrid Grid.Column="0" x:Name="dgNhaCungCap" AutoGenerateColumns="False" IsReadOnly="True" SelectionMode="Single" SelectionChanged="DgNhaCungCap_SelectionChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="ID" Binding="{Binding IdNhaCungCap}" Width="50"/>
                        <DataGridTextColumn Header="Tên Nhà Cung Cấp" Binding="{Binding TenNhaCungCap}" Width="*"/>
                        <DataGridTextColumn Header="Số điện thoại" Binding="{Binding SoDienThoai}" Width="150"/>
                        <DataGridTextColumn Header="Địa chỉ" Binding="{Binding DiaChi}" Width="200"/>
                    </DataGrid.Columns>
                </DataGrid>

                <StackPanel Grid.Column="1" Width="300" Margin="10,0,0,0">
                    <GroupBox Header="Thông tin Nhà Cung cấp">
                        <StackPanel Margin="10">
                            <Label Content="Tên nhà cung cấp:"/>
                            <TextBox x:Name="txtTenNCC" Margin="0,0,0,10"/>
                            <Label Content="Số điện thoại:"/>
                            <TextBox x:Name="txtSdtNCC" Margin="0,0,0,10"/>
                            <Label Content="Địa chỉ:"/>
                            <TextBox x:Name="txtDiaChiNCC" Margin="0,0,0,10" Height="60" TextWrapping="Wrap"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="btnLamMoiNCC" Content="Làm mới" Margin="5" Padding="10,5" Click="BtnLamMoiNCC_Click"/>
                                <Button x:Name="btnThemNCC" Content="Thêm" Margin="5" Padding="10,5" Click="BtnThemNCC_Click"/>
                                <Button x:Name="btnLuuNCC" Content="Lưu" Margin="5" Padding="10,5" Click="BtnLuuNCC_Click"/>
                                <Button x:Name="btnXoaNCC" Content="Xóa" Margin="5" Padding="10,5" Background="IndianRed" Foreground="White" Click="BtnXoaNCC_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </Grid>
        </TabItem>
    </TabControl>
</Page>